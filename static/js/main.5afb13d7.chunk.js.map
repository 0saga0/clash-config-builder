{"version":3,"sources":["components/sharedGroup.js","components/inputDrawer.js","App.js","utils/cache.js","index.js"],"names":["items","onChange","its","map","val","className","key","uniqueId","data-id","options","group","animation","props","title","visible","v","isHieghtlight","useState","value","setValue","useEffect","placement","onClose","width","onValueChange","code","highlight","languages","yaml","padding","style","fontFamily","fontSize","borderRadius","backgroundColor","color","fileDownload","require","Header","Content","Sider","Footer","RAW_CONFIG","SUB_CONFIG","PROXIES_CONFIG","IS_FLAT_RULESET","RULE_TYPES","localPort","client","create","baseURL","headers","useLocalStorage","initValue","c","str","window","localStorage","getItem","JSON","parse","getCache","setItem","stringify","setCache","useDrawerInput","cacheKey","setVisible","t","App","rawConfig","setRawConfig","setRawDrawerVisible","subsURLs","setSubDrawerVisible","syncBtnLoading","setSyncBtnLoading","groupIndex","setGroupIndex","moreFileterStr","setMoreFilterStr","isLocalMode","setIsLocalMode","get","then","data","status","subProxies","setSubProxies","isFlatRuleset","setIsFlatRuleset","rawObj","setRawObj","a","request","url","resp","urls","split","filter","test","proxyURL","all","encodeURIComponent","resps","proxies","forEach","index","yml","ymlParse","p","concat","notification","error","message","description","stack","groups","rules","finalRules","rule","ps","trim","type","proxy","lines","l","payload","args","includes","res","r","finalProxies","allProxyNames","name","g","entries","idx","fileName","fileContent","ymlStringify","method","location","href","obj","gs","proxyGroupNames","use","Item","groupProxies","length","moreProxies","exp","RegExp","theme","mode","selectedKeys","lineHeight","onClick","open","background","item","height","borderRight","count","overflowCount","offset","order","placeholder","e","target","allowClear","loading","icon","checked","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.5afb13d7.chunk.js","sourcesContent":["import React from 'react'\n\nimport Sortable from 'react-sortablejs';\nimport uniqueId from 'lodash/uniqueId';\n\nexport default function({ items = [], onChange = () => { } }) {\n  const its = items.map(val => (<div className=\"menu-item\" key={uniqueId()} data-id={val}>{val}</div>));\n\n  return (\n    <Sortable\n      options={{\n        group: 'shared',\n        animation: 150,\n      }}\n      onChange={onChange}\n      className=\"menu\"\n    >\n      {its}\n    </Sortable>\n  );\n}","import React, { useState, useEffect } from 'react'\nimport Editor from 'react-simple-code-editor';\nimport { highlight, languages } from 'prismjs/components/prism-core';\nimport 'prismjs/components/prism-yaml';\nimport 'prismjs/components/prism-json'\nimport 'prismjs/themes/prism-okaidia.css'\nimport { Drawer } from 'antd'\n\n\nexport default function (props) {\n    const { title = \"\", visible = false, onChange, 'value': v, isHieghtlight = true } = props\n    const [value, setValue] = useState(v)\n\n    useEffect(() => {\n        setValue(v)\n    }, [v])\n\n    return (\n        <Drawer\n            title={title}\n            placement=\"right\"\n            onClose={() => onChange(value)}\n            visible={visible}\n            width={\"84%\"}\n        >\n            <Editor\n                value={value}\n                onValueChange={code => setValue(code)}\n                highlight={code => isHieghtlight ? highlight(code, languages.yaml, 'yaml') : code}\n                padding={10}\n                style={{\n                    fontFamily: '\"Fira code\", \"Fira Mono\", monospace',\n                    fontSize: 14,\n                    borderRadius: 5,\n                    backgroundColor: \"rgb(40, 44, 52)\",\n                    color: \"#ffffff\"\n                }}\n            />\n        </Drawer>\n    )\n}","import React, { useState, useEffect } from 'react';\nimport { Layout, Menu, Button, notification, Empty, Tag, message, Input, Checkbox, Badge } from 'antd'\nimport { parse as ymlParse, stringify as ymlStringify } from 'yaml'\nimport { get, all, create } from 'axios'\n\n\nimport SharedGroup from './components/sharedGroup'\nimport RawDrawer from './components/inputDrawer'\n\nimport { setCache, getCache } from \"./utils/cache\"\n\nimport './App.css';\n\nconst fileDownload = require('react-file-download')\n\nconst { Header, Content, Sider, Footer } = Layout;\n\nconst RAW_CONFIG = \"raw\"\nconst SUB_CONFIG = \"subs\"\nconst PROXIES_CONFIG = \"proxies\"\nconst IS_FLAT_RULESET = \"isFlatRules\"\n\nconst RULE_TYPES = [\"DOMAIN-SUFFIX\", \"DOMAIN-KEYWORD\", \"DOMAIN\", \"DOMAIN-SUFFIX\", \"IP-CIDR\", \"GEOIP\", \"FINAL\"]\n\nconst localPort = 54637\nconst client = create({\n  baseURL: `http://127.0.0.1:${localPort}`,\n  headers: {\n    'content-type': 'application/x-www-form-urlencoded'\n  }\n})\n\nfunction App() {\n  const rawConfig = useDrawerInput({ title: \"Input raw config.yaml\", cacheKey: RAW_CONFIG })\n  const { 'setValue': setRawConfig, 'setVisible': setRawDrawerVisible } = rawConfig\n  const subsURLs = useDrawerInput({ title: \"Input subscriptions(.yaml) url line by line\", cacheKey: SUB_CONFIG })\n  const { 'setVisible': setSubDrawerVisible } = subsURLs\n  const [syncBtnLoading, setSyncBtnLoading] = useState(false)\n  const [groupIndex, setGroupIndex] = useState(\"0\")\n  const [moreFileterStr, setMoreFilterStr] = useState(\"\")\n\n  const [isLocalMode, setIsLocalMode] = useState(false)\n  useEffect(() => {\n    client.get('/ping').then(({ data = \"\", status }) => {\n      setIsLocalMode(status === 200 && data === \"pong\")\n    })\n  }, [])\n\n  const [subProxies, setSubProxies] = useLocalStorage(PROXIES_CONFIG, [])\n  const [isFlatRuleset, setIsFlatRuleset] = useLocalStorage(IS_FLAT_RULESET, true)\n\n  const [rawObj, setRawObj] = useState({})\n  useEffect(() => {\n    let obj = {}\n    try {\n      obj = ymlParse(rawConfig.value)\n    } catch{ }\n    setRawObj(obj || {})\n  }, [rawConfig.value])\n\n  async function handleSyncProxies() {\n    const request = async url => {\n      try {\n        let resp = await get(url)\n        return resp.data\n      } catch {\n        return \"\"\n      }\n    }\n\n    setSyncBtnLoading(true)\n    try {\n      const urls = subsURLs.value.split('\\n').filter(url => /^https?:\\/\\//.test(url))\n      const proxyURL = isLocalMode ? `http://127.0.0.1:${localPort}/proxy?url=` : \"https://cloudcompute.lbyczf.com/proxy-content?url=\"\n      const resps = await all(urls.map(url => request(`${proxyURL}${encodeURIComponent(url)}`)))\n      let proxies = []\n      resps.forEach((data, index) => {\n        if (data === \"\") {\n          notification.error({\n            message: \"Could not download from subscription\",\n            description: urls[index]\n          })\n          return\n        }\n        let yml = {}\n        try {\n          yml = ymlParse(data)\n        } catch{ }\n        const { 'Proxy': p = [] } = yml\n        proxies = proxies.concat(p)\n      })\n      setSubProxies(proxies)\n    } catch (e) {\n      notification.error({\n        message: \"Sync Error\",\n        description: e.stack,\n      })\n    }\n    setSyncBtnLoading(false)\n  }\n\n  function handleProxiesChange(order) {\n    let { 'Proxy Group': gs = [] } = rawObj\n    gs[groupIndex].proxies = order\n    const yml = ymlStringify({ ...rawObj, 'Proxy Group': gs })\n    setRawConfig(yml)\n  }\n\n  function handleMoreFilterChange(e) {\n    const { value } = e.target\n    setMoreFilterStr(value)\n  }\n\n  function handleIsFlatRulesetChange(e) {\n    const { checked = true } = e.target\n    setIsFlatRuleset(checked)\n  }\n\n  async function handleDownloadProfile() {\n    const { 'Proxy': proxies = [], 'Proxy Group': groups = [], 'Rule': rules = [] } = rawObj\n    let finalRules = []\n    for (let rule of rules) {\n      const ps = rule.split(',').map(p => p.trim())\n      const [type, url, proxy] = ps\n      if (type === 'RULE-SET' && isFlatRuleset) {\n        try {\n          const resp = await get(url)\n          const { status, data } = resp\n          if (status === 200) {\n            const lines = data.split('\\n')\n            finalRules = [...finalRules, ...lines.map(l => {\n              const [type, payload, args] = l.split(',').map(p => p.trim())\n              if (!RULE_TYPES.includes(type)) return null;\n              let res = `${type},${payload},${proxy}`\n              if (args === 'no-resolve') {\n                res += \",no-resolve\"\n              }\n              return res\n            }).filter(r => r)]\n          }\n        } catch {\n          notification.error({\n            message: \"Ruleset download failed\",\n            description: url\n          })\n          return\n        }\n      } else {\n        finalRules = [...finalRules, rule]\n      }\n    }\n    const finalProxies = proxies.concat(subProxies)\n    const allProxyNames = [\n      ...finalProxies.map(p => p.name),\n      ...groups.map(g => g.name),\n      ...[\"DIRECT\", \"REJECT\", \"GLOBAL\"]\n    ]\n    for (let [idx, g] of groups.entries()) {\n      const { proxies = [] } = g\n      for (let ps of proxies) {\n        if (!allProxyNames.includes(ps)) {\n          message.error(`Group [${g.name}] contains a not exist proxy [${ps}]`, 5)\n          setGroupIndex(idx + \"\")\n          return\n        }\n      }\n    }\n    const fileName = 'config.yml'\n    const fileContent = ymlStringify({ ...rawObj, 'Proxy': finalProxies, 'Rule': finalRules })\n    if (isLocalMode) {\n      const { 'status': s } = await client({\n        method: \"post\",\n        url: \"/config\",\n        data: \"config=\" + encodeURIComponent(fileContent)\n      })\n      if (s === 204) {\n        window.location.href = `clash://install-config?url=${encodeURIComponent(`http://127.0.0.1:${localPort}/config`)}`\n      }\n    } else {\n      fileDownload(fileContent, fileName)\n    }\n  }\n\n  const { 'Proxy Group': gs = [], 'Proxy': ps = [] } = rawObj\n  const proxyGroupNames = gs.map((g, idx) => {\n    const { use } = g\n    return (\n      <Menu.Item key={idx}>{g.name}</Menu.Item>\n    )\n  })\n\n  let groupProxies = []\n  if (groupIndex < gs.length) {\n    const { proxies = [] } = gs[groupIndex * 1]\n    groupProxies = proxies\n  }\n\n  const moreProxies = [\n    'DIRECT',\n    'GLOBAL',\n    'REJECT',\n    ...gs.map(g => g.name),\n    ...ps.map(p => p.name),\n    ...subProxies.map(p => p.name)\n  ].filter(p => {\n    let exp = /^/\n    try {\n      exp = new RegExp(moreFileterStr)\n    } catch { }\n    return !groupProxies.includes(p) && exp.test(p)\n  })\n\n  return (\n    <Layout className=\"main\">\n      <Header className=\"header\">\n        <Menu\n          theme=\"dark\"\n          mode=\"horizontal\"\n          selectedKeys={['1']}\n          style={{ lineHeight: '64px' }}\n        >\n          <Menu.Item key=\"1\">Proxy Group</Menu.Item>\n          <Menu.Item key=\"2\" onClick={() => setRawDrawerVisible(true)}>Raw Config</Menu.Item>\n          <Menu.Item key=\"3\" onClick={() => setSubDrawerVisible(true)}>Subscription</Menu.Item>\n          <Menu.Item key=\"4\" onClick={() => window.open(\"https://github.com/Fndroid/clash-config-builder\", \"_blank\")}>Github</Menu.Item>\n        </Menu>\n      </Header>\n      <Layout>\n        <Sider width={200} style={{ background: '#fff' }}>\n          <Menu\n            mode=\"inline\"\n            selectedKeys={[groupIndex]}\n            onClick={(item) => setGroupIndex(item.key)}\n            style={{ height: '100%', borderRight: 0 }}\n          >\n            {proxyGroupNames}\n          </Menu>\n        </Sider>\n        <Layout style={{ padding: '0 24px 24px' }}>\n          <Content\n            className=\"content\"\n          >\n            <div className=\"list\">\n              <Badge count={groupProxies.length} overflowCount={2000} offset={[20, 0]} style={{ backgroundColor: '#f50' }}>\n                <div className=\"list-title\">Proxies</div>\n              </Badge>\n              {/* <Empty hidden={groupProxies.length !== 0} /> */}\n              <SharedGroup\n                items={groupProxies}\n                onChange={handleProxiesChange}\n              />\n            </div>\n\n            <div className=\"list\">\n              <Badge count={moreProxies.length} overflowCount={2000} offset={[20, 0]} style={{ backgroundColor: '#52c41a' }}>\n                <div className=\"list-title\">More</div>\n              </Badge>\n              <SharedGroup\n                items={moreProxies}\n                onChange={() => { }}\n              />\n              <Input\n                className=\"filter-input\"\n                placeholder=\"flter by regular expression\"\n                value={moreFileterStr}\n                onChange={handleMoreFilterChange}\n                allowClear\n              ></Input>\n            </div>\n\n          </Content>\n        </Layout>\n      </Layout>\n      <Footer className=\"footer\">\n        <Button className=\"btn\" loading={syncBtnLoading} icon=\"cloud-download\" onClick={handleSyncProxies}>Sync Proxies</Button>\n        <Button className=\"btn\" type=\"primary\" icon=\"download\" onClick={handleDownloadProfile}>Download Profile</Button>\n        <Checkbox className='btn' checked={isFlatRuleset} onChange={handleIsFlatRulesetChange}>Flat Ruleset</Checkbox>\n        <Tag className=\"btn mode-tag\" color={isLocalMode ? \"green\" : \"volcano\"}>{`${isLocalMode ? \"Local\" : \"Remote\"} Mode`}</Tag>\n      </Footer>\n      <RawDrawer\n        {...rawConfig}\n      ></RawDrawer>\n      <RawDrawer\n        {...subsURLs}\n        isHieghtlight={false}\n      ></RawDrawer>\n    </Layout>\n  );\n}\n\nfunction useLocalStorage(key, initValue) {\n  const c = getCache(key)\n  const [value, setValue] = useState(c === null ? initValue : c)\n\n  function setValueCache(val) {\n    setValue(val)\n    setCache(key, val)\n  }\n\n  return [value, setValueCache]\n}\n\nfunction useDrawerInput({ title, initValue = \"\", cacheKey }) {\n  const [value, setValue] = useLocalStorage(cacheKey, initValue)\n  const [visible, setVisible] = useState(false)\n\n  function handleChange(t) {\n    setVisible(false)\n    setValue(t)\n  }\n\n  return {\n    title,\n    visible,\n    value,\n    onChange: handleChange,\n    setValue,\n    setVisible,\n  }\n}\n\n\nexport default App;\n","function setCache(key, value) {\n    window.localStorage.setItem(key, JSON.stringify(value))\n}\n\nfunction getCache(key) {\n    const str = window.localStorage.getItem(key)\n    try {\n        const obj = JSON.parse(str)\n        return obj\n    } catch{ }\n    return str\n}\n\nexport {\n    setCache,\n    getCache\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n// import * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\n// serviceWorker.unregister();\n"],"sourceRoot":""}